{% extends 'base.html' %}
{% block content %}

<div style="max-width: 800px; margin: 0 auto;">
    <!-- 1. æœç´¢è¡¨å•åŒºåŸŸ -->
    <div class="card" style="padding: 40px; text-align: center; border-bottom: 4px solid #81c784;">
        <h2 style="margin-bottom: 25px; color: #546e7a;">æœç´¢ä½ æ„Ÿå…´è¶£çš„å†…å®¹</h2>

        <form action="{{ url_for('search') }}" method="GET"
              style="display: flex; flex-direction: column; gap: 20px; align-items: center;">
            <!-- æœç´¢æ¡† -->
            <div style="width: 100%; max-width: 600px; position: relative;">
                <input type="text" name="q" value="{{ query }}" class="modern-input"
                       placeholder="è¾“å…¥å…³é”®è¯..."
                       style="padding: 15px 20px; font-size: 16px; border-radius: 30px; box-shadow: 0 4px 10px rgba(0,0,0,0.05);">
                <button type="submit" class="btn"
                        style="position: absolute; right: 5px; top: 5px; border-radius: 25px; padding: 10px 25px;">æœç´¢
                </button>
            </div>

            <!-- æœç´¢æ ‡å‡†é€‰æ‹© -->
            <div style="display: flex; gap: 20px;">
                <label style="cursor: pointer; display: flex; align-items: center; gap: 5px; color: #666;">
                    <input type="radio" name="type" value="article" {% if search_type== 'article' %}checked{% endif %}>
                    æœæ–‡ç« 
                </label>
                <label style="cursor: pointer; display: flex; align-items: center; gap: 5px; color: #666;">
                    <input type="radio" name="type" value="user" {% if search_type== 'user' %}checked{% endif %}> æœä½œè€…
                </label>
            </div>
        </form>
    </div>

    <!-- 2. ç»“æœå±•ç¤ºåŒºåŸŸ -->
    <div style="margin-top: 40px;">
        {% if query %}
        <p style="color: #999; margin-bottom: 20px;">æ‰¾åˆ°å…³äº â€œ{{ query }}â€ çš„ {{ results|length }} æ¡ç»“æœï¼š</p>

        {% if search_type == 'article' %}
        <!-- æ–‡ç« ç»“æœåˆ—è¡¨ï¼šå¤ç”¨ä¹‹å‰çš„ç½‘æ ¼å¸ƒå±€ï¼ˆå¯ä»¥æ”¹ä¸ºåˆ—è¡¨å¼æ›´æ¸…æ™°ï¼‰ -->
        <div style="display: flex; flex-direction: column; gap: 15px;">
            {% for article in results %}
            <div class="card" style="padding: 20px; display: flex; gap: 20px; align-items: center; transition: 0.3s;"
                 onmouseover="this.style.transform='translateX(10px)'"
                 onmouseout="this.style.transform='translateX(0)'">
                <img src="{{ article.cover_url or '/static/images/default_cover.png' }}"
                     style="width: 120px; height: 80px; object-fit: cover; border-radius: 8px;">
                <div style="flex: 1;">
                    <h3 style="margin: 0 0 5px 0;">
                        <a href="{{ url_for('view_article', article_id=article.id) }}"
                           style="text-decoration: none; color: #333;">{{ article.title }}</a>
                    </h3>
                    <div style="font-size: 13px; color: #999;">ä½œè€…ï¼š{{ article.author.nickname or
                        article.author.username }} | {{ article.update_time.strftime('%Y-%m-%d') }}
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
        {% else %}
        <!-- ç”¨æˆ·ç»“æœåˆ—è¡¨ -->
        <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 20px;">
            {% for user in results %}
            <div class="card" style="text-align: center; padding: 25px; transition: 0.3s;"
                 onmouseover="this.style.transform='translateY(-5px)'"
                 onmouseout="this.style.transform='translateY(0)'">
                <img src="{{ user.avatar_url }}"
                     style="width: 80px; height: 80px; border-radius: 50%; border: 3px solid #f1f8e9; margin-bottom: 10px;">
                <div style="font-weight: bold; color: #333;">{{ user.nickname or user.username }}</div>
                <div style="font-size: 12px; color: #aaa; margin-bottom: 15px;">@{{ user.username }}</div>
                <a href="{{ url_for('public_profile', user_id=user.id) }}" class="btn"
                   style="padding: 5px 15px; font-size: 12px; background: transparent; color: #81c784 !important; border: 1px solid #81c784;">æŸ¥çœ‹ä¸»é¡µ</a>
            </div>
            {% endfor %}
        </div>
        {% endif %}

        {% if not results %}
        <div style="text-align: center; padding: 50px; color: #ccc;">
            <p style="font-size: 50px; margin-bottom: 10px;">ğŸœï¸</p>
            <p>æ²¡æ‰¾åˆ°ç›¸å…³å†…å®¹ï¼Œæ¢ä¸ªè¯è¯•è¯•ï¼Ÿ</p>
        </div>
        {% endif %}
        {% endif %}
    </div>
</div>

<style>
    /* æœç´¢é¡µå•é€‰æ¡†é¢œè‰²å¾®è°ƒ */
    input[type="radio"] {
        accent-color: #81c784;
    }
</style>

{% endblock %}